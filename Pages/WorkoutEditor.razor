@page "/workout-editor/{WorkoutId}"
@using EdzesPlatform.Models
@using EdzesPlatform.Services
@inject DataService Data
@inject NavigationManager Nav
@inject IJSRuntime JSRuntime
@inject WorkoutExportService Exporter

<div class="container mt-4 pb-5">
    @if (workout == null)
    {
        <div class="text-white">Betöltés...</div>
    }
    else
    {
        <div class="card mb-3 border-secondary">
            <div class="card-body bg-dark text-white">
                <div class="d-flex justify-content-between mb-3">
                    @* BAL OLDAL: Vissza + SABLONOK + Export *@
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-secondary btn-sm" @onclick="GoBack">
                            <i class="bi bi-arrow-left"></i> Mégse
                        </button>

                        @* SABLON MENÜ *@
                        <div class="dropdown">
                            <button class="btn btn-outline-info btn-sm dropdown-toggle" type="button" @onclick="ToggleTemplateMenu">
                                <i class="bi bi-collection"></i> Sablonok
                            </button>
                            <ul class="dropdown-menu dropdown-menu-dark @(isTemplateMenuOpen ? "show" : "")"
                                style="position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(0px, 33px); min-width: 250px;">

                                <li>
                                    <button class="dropdown-item text-warning" @onclick="SaveCurrentAsTemplate">
                                        <i class="bi bi-save"></i> Mentés sablonként
                                    </button>
                                </li>
                                <li><hr class="dropdown-divider"></li>

                                @if (templates == null)
                                {
                                    <li><span class="dropdown-item text-muted">Betöltés...</span></li>
                                }
                                else if (!templates.Any())
                                {
                                    <li><span class="dropdown-item text-muted">Nincs mentett sablon</span></li>
                                }
                                else
                                {
                                    @foreach (var t in templates)
                                    {
                                        <li>
                                            <div class="d-flex align-items-center justify-content-between px-2 py-1">
                                                @* A sablon neve betölti az edzést *@
                                                <button class="dropdown-item text-truncate me-2 rounded"
                                                        @onclick="() => LoadTemplate(t)"
                                                        title="@t.Description">
                                                    @t.Title
                                                </button>

                                                @* Törlés gomb (Kuka) *@
                                                <button class="btn btn-sm btn-outline-danger border-0"
                                                        @onclick="() => DeleteTemplate(t)"
                                                        @onclick:stopPropagation="true"
                                                        title="Sablon törlése">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                        </li>
                                    }
                                }
                            </ul>
                        </div>

                        @* EXPORT *@
                        <button class="btn btn-outline-light btn-sm" @onclick="OpenExportModal">
                            <i class="bi bi-cloud-download"></i> Exportálás
                        </button>
                    </div>

                    @* JOBB OLDAL: Törlés + Befejezés + Mentés *@
                    <div class="d-flex gap-2">
                        <button class="btn btn-danger btn-sm" @onclick="DeleteThisWorkout" title="Edzés törlése">
                            <i class="bi bi-trash"></i>
                        </button>

                        @* BEFEJEZÉS GOMB - Csak akkor aktív, ha még nincs kész *@
                        @if (workout.Status != "done")
                        {
                            <button class="btn btn-outline-success btn-sm" @onclick="() => showFinishModal = true">
                                <i class="bi bi-flag-fill"></i> Befejezés
                            </button>
                        }

                        <button class="btn btn-success" @onclick="SaveWorkout">
                            <i class="bi bi-check-lg"></i> Mentés
                        </button>
                    </div>
                </div>

                @* FŐ CÍM ÉS DÁTUM *@
                <div class="row g-2 mb-3">
                    <div class="col-md-8">
                        <label class="small text-muted">Edzés neve</label>
                        <div class="input-group">
                            @if (workout.Status == "done")
                            {
                                <span class="input-group-text bg-success text-white border-0"><i class="bi bi-check-circle-fill"></i></span>
                            }
                            <input class="form-control form-control-lg bg-secondary text-white border-0 fw-bold" @bind="workout.Title" />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="small text-muted">Dátum</label>
                        <input type="date" class="form-control form-control-lg bg-secondary text-white border-0" @bind="workout.Date" />
                    </div>
                </div>

                @* --- NAPLÓZÁS RÉSZ (RPE + EMOJI) --- *@
                <div class="row g-2 mb-3 p-2 border border-secondary rounded" style="background: #252525;">
                    <div class="col-12 text-muted small mb-1 text-uppercase fw-bold">
                        <i class="bi bi-journal-text"></i> Naplózás & Érzés
                    </div>
                    <div class="col-md-6">
                        <label class="small text-muted d-flex justify-content-between">
                            <span>Nehézség (RPE): <span class="@GetRpeColor(workout.Rpe ?? 0) fw-bold">@(workout.Rpe ?? 0)/10</span></span>
                        </label>
                        <input type="range" class="form-range" min="0" max="10" step="1" @bind="workout.Rpe" />
                        <div class="d-flex justify-content-between small text-muted" style="font-size: 0.7rem;">
                            <span>Könnyű</span>
                            <span>Közepes</span>
                            <span>Max</span>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <label class="small text-muted d-block mb-1">Hogy érezted magad?</label>
                        <div class="btn-group w-100" role="group">
                            <button type="button" class="btn btn-sm @(workout.Feeling == "terrible" ? "btn-secondary text-danger fw-bold border-danger" : "btn-outline-secondary")" @onclick='() => workout.Feeling = "terrible"'> 🤮 </button>
                            <button type="button" class="btn btn-sm @(workout.Feeling == "bad" ? "btn-danger" : "btn-outline-secondary")" @onclick='() => workout.Feeling = "bad"'> 😫 </button>
                            <button type="button" class="btn btn-sm @(workout.Feeling == "neutral" ? "btn-warning" : "btn-outline-secondary")" @onclick='() => workout.Feeling = "neutral"'> 😐 </button>
                            <button type="button" class="btn btn-sm @(workout.Feeling == "good" ? "btn-success" : "btn-outline-secondary")" @onclick='() => workout.Feeling = "good"'> 🙂 </button>
                            <button type="button" class="btn btn-sm @(workout.Feeling == "excellent" ? "btn-info text-white" : "btn-outline-secondary")" @onclick='() => workout.Feeling = "excellent"'> 🤩 </button>
                        </div>
                    </div>
                </div>

                @* LEÍRÁS *@
                <div class="mt-2">
                    <textarea class="form-control bg-secondary text-white border-0" rows="2" @bind="workout.Description" placeholder="Megjegyzés az edzéshez..."></textarea>
                </div>
            </div>
        </div>

        @* EDZÉS BLOKKOK *@
        <div class="row">
            <div class="col-md-5 mb-4">
                <h5 class="text-white mb-3">Edzés Blokkjaid</h5>
                <div class="list-group shadow-sm">
                    @foreach (var step in workout.Steps)
                    {
                        bool isActive = selectedStep == step;
                        <button class="list-group-item list-group-item-action d-flex justify-content-between align-items-center @(isActive ? "active-step" : "bg-dark text-white border-secondary")"
                                @onclick="() => SelectStep(step)">
                            <div class="d-flex align-items-center">
                                <div class="zone-stripe me-3" style="background-color: @GetZoneColor(step.Zone)"></div>
                                <div>
                                    @if (step.Type == "Intervals")
                                    {
                                        <div class="fw-bold">@step.RepeatCount x (@FormatTime(step.DurationSeconds) / @FormatTime(step.OffDurationSeconds))</div>
                                        <div class="small opacity-75">@step.Zone / @step.OffZone</div>
                                    }
                                    else
                                    {
                                        <div class="fw-bold">@FormatTime(step.DurationSeconds) @step.Zone</div>
                                    }
                                </div>
                            </div>
                            <div class="btn-group btn-group-sm">
                                <span class="btn btn-link text-danger" @onclick:stopPropagation="true" @onclick="() => RemoveStep(step)"><i class="bi bi-trash"></i></span>
                            </div>
                        </button>
                    }
                </div>
                <div class="d-flex gap-2 mt-3">
                    <button class="btn btn-outline-primary w-100" @onclick="AddSteadyState"><i class="bi bi-plus-lg"></i> Folyamatos</button>
                    <button class="btn btn-outline-warning w-100" @onclick="AddInterval"><i class="bi bi-repeat"></i> Intervallum</button>
                </div>
            </div>

            <div class="col-md-7">
                @if (selectedStep != null)
                {
                    <div class="card border-secondary sticky-top" style="top: 20px;">
                        <div class="card-header bg-dark text-white fw-bold border-secondary">Blokk Szerkesztése</div>
                        <div class="card-body bg-dark text-white">
                            <div class="mb-3">
                                <label class="small text-muted">Típus</label>
                                <select class="form-select bg-secondary text-white border-0" @bind="selectedStep.Type">
                                    <option value="SteadyState">Folyamatos</option>
                                    <option value="Intervals">Intervallum</option>
                                </select>
                            </div>
                            @if (selectedStep.Type == "Intervals")
                            {
                                <div class="mb-3">
                                    <label class="small text-muted">Ismétlés</label>
                                    <input type="number" class="form-control bg-secondary text-white border-0" @bind="selectedStep.RepeatCount" />
                                </div>
                            }

                            <h6 class="text-primary border-bottom border-secondary pb-2">Munka / Időtartam</h6>
                            <div class="input-group mb-2">
                                <input type="number" class="form-control bg-secondary text-white border-0"
                                       value="@(selectedStep.DurationSeconds / 60)"
                                       @onchange="@(e => UpdateTime(selectedStep, e.Value, true, true))" placeholder="p" />
                                <span class="input-group-text bg-dark border-secondary text-white">p</span>
                                <input type="number" class="form-control bg-secondary text-white border-0"
                                       value="@(selectedStep.DurationSeconds % 60)"
                                       @onchange="@(e => UpdateTime(selectedStep, e.Value, false, true))" placeholder="mp" />
                                <span class="input-group-text bg-dark border-secondary text-white">mp</span>
                            </div>
                            <div class="row mb-3">
                                <div class="col-6">
                                    <select class="form-select bg-secondary text-white border-0" @bind="selectedStep.Zone">
                                        @foreach (var z in zones)
                                        {
                                            <option value="@z">@z</option>
                                        }
                                    </select>
                                </div>
                                <div class="col-6">
                                    <input type="number" class="form-control bg-secondary text-white border-0" @bind="selectedStep.Cadence" placeholder="RPM" />
                                </div>
                            </div>

                            @if (selectedStep.Type == "Intervals")
                            {
                                <h6 class="text-success border-bottom border-secondary pb-2 mt-3">Pihenő</h6>
                                <div class="input-group mb-2">
                                    <input type="number" class="form-control bg-secondary text-white border-0"
                                           value="@(selectedStep.OffDurationSeconds / 60)"
                                           @onchange="@(e => UpdateTime(selectedStep, e.Value, true, false))" placeholder="p" />
                                    <span class="input-group-text bg-dark border-secondary text-white">p</span>
                                    <input type="number" class="form-control bg-secondary text-white border-0"
                                           value="@(selectedStep.OffDurationSeconds % 60)"
                                           @onchange="@(e => UpdateTime(selectedStep, e.Value, false, false))" placeholder="mp" />
                                    <span class="input-group-text bg-dark border-secondary text-white">mp</span>
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <select class="form-select bg-secondary text-white border-0" @bind="selectedStep.OffZone">
                                            @foreach (var z in zones)
                                            {
                                                <option value="@z">@z</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-6">
                                        <input type="number" class="form-control bg-secondary text-white border-0" @bind="selectedStep.OffCadence" placeholder="Pihi RPM" />
                                    </div>
                                </div>
                            }

                            <div class="mt-3">
                                <label class="small text-muted">Instrukció</label>
                                <input class="form-control bg-secondary text-white border-0" @bind="selectedStep.Instruction" placeholder="Megjelenő szöveg..." />
                            </div>
                        </div>
                    </div>
                }
                else
                {
                    <div class="alert alert-secondary bg-dark text-muted border-secondary text-center">Válassz blokkot!</div>
                }
            </div>
        </div>
    }
</div>

@* --- MODAL: EXPORT --- *@
@if (showExportModal)
{
    <div class="modal-backdrop fade show"></div>
    <div class="modal fade show d-block" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-white border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title">Exportálás</h5>
                    <button type="button" class="btn-close btn-close-white" @onclick="() => showExportModal = false"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs border-secondary mb-3">
                        <li class="nav-item">
                            <a class="nav-link @(exportTab == 0 ? "active bg-secondary text-white" : "text-muted")"
                               style="cursor:pointer" @onclick="() => exportTab = 0">Intervals.icu</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(exportTab == 1 ? "active bg-secondary text-white" : "text-muted")"
                               style="cursor:pointer" @onclick="() => exportTab = 1">Wahoo / Zwift (.zwo)</a>
                        </li>
                    </ul>

                    @if (exportTab == 0) // INTERVALS
                    {
                        <div class="d-flex justify-content-center mb-3">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn @(!exportUseHr ? "btn-warning" : "btn-outline-secondary")" @onclick="() => ToggleIntervalsMode(false)">Watt alapú</button>
                                <button type="button" class="btn @(exportUseHr ? "btn-danger" : "btn-outline-secondary")" @onclick="() => ToggleIntervalsMode(true)">Pulzus alapú</button>
                            </div>
                        </div>
                        <div class="d-grid">
                            <button class="btn btn-primary" @onclick="DownloadIntervalsFile"><i class="bi bi-file-text"></i> Letöltés (.txt)</button>
                        </div>
                    }
                    else if (exportTab == 1) // WAHOO / ZWIFT
                    {
                        <div class="alert alert-info small bg-secondary border-0 text-white">
                            A .zwo formátum a legjobb választás Wahoo-hoz és Zwifthez. Mivel abszolút wattokat használunk, add meg a Wahoo FTP-det a helyes számításhoz.
                        </div>
                        <label class="form-label">Wahoo-n beállított FTP (Watt):</label>
                        <input type="number" class="form-control bg-dark text-white border-secondary mb-3" @bind="exportFtp" />
                        <div class="d-grid">
                            <button class="btn btn-warning" @onclick="DownloadWahooZwo"><i class="bi bi-download"></i> Letöltés (.zwo)</button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}

@* --- MODAL: EDZÉS BEFEJEZÉSE (GRATULÁLOK) --- *@
@if (showFinishModal)
{
    <div class="modal-backdrop fade show"></div>
    <div class="modal fade show d-block" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-white border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-success"><i class="bi bi-trophy-fill"></i> Gratulálok!</h5>
                    <button type="button" class="btn-close btn-close-white" @onclick="() => showFinishModal = false"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">Hogyan ment az edzés? Értékeld a teljesítményed!</p>

                    <label class="form-label">Nehézség (RPE)</label>
                    <div class="d-flex align-items-center gap-3 mb-3">
                        <input type="range" class="form-range" min="1" max="10" step="1" @bind="tempRpe">
                        <span class="fw-bold fs-4 @GetRpeColor(tempRpe)">@tempRpe</span>
                    </div>

                    <label class="form-label">Érzés</label>
                    <div class="btn-group w-100 mb-3" role="group">
                        <button type="button" class="btn btn-sm @(tempFeeling == "terrible" ? "btn-secondary text-danger border-danger" : "btn-outline-secondary")" @onclick='() => tempFeeling = "terrible"'> 🤮 </button>
                        <button type="button" class="btn btn-sm @(tempFeeling == "bad" ? "btn-danger" : "btn-outline-secondary")" @onclick='() => tempFeeling = "bad"'> 😫 </button>
                        <button type="button" class="btn btn-sm @(tempFeeling == "neutral" ? "btn-warning" : "btn-outline-secondary")" @onclick='() => tempFeeling = "neutral"'> 😐 </button>
                        <button type="button" class="btn btn-sm @(tempFeeling == "good" ? "btn-success" : "btn-outline-secondary")" @onclick='() => tempFeeling = "good"'> 🙂 </button>
                        <button type="button" class="btn btn-sm @(tempFeeling == "excellent" ? "btn-info text-white" : "btn-outline-secondary")" @onclick='() => tempFeeling = "excellent"'> 🤩 </button>
                    </div>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" @onclick="() => showFinishModal = false">Mégse</button>
                    <button type="button" class="btn btn-success" @onclick="ConfirmFinish">Rögzítés & Kész</button>
                </div>
            </div>
        </div>
    </div>
}

<style>
    .active-step {
        background-color: #2c3035 !important;
        border: 1px solid #0d6efd !important;
        color: white;
    }

    .zone-stripe {
        width: 6px;
        height: 40px;
        border-radius: 4px;
        flex-shrink: 0;
    }

    .modal-backdrop {
        background-color: rgba(0,0,0,0.8);
    }
</style>

@code {
    [Parameter] public string WorkoutId { get; set; } = "";

    private Workout? workout;
    private WorkoutStep? selectedStep;
    private List<string> zones = new() { "KB", "GA1", "GA2", "EB", "VO2", "SB", "K3" };
    private ZoneSnapshotData? currentZoneSettings;

    // SABLONOK
    private bool isTemplateMenuOpen = false;
    private List<WorkoutTemplate>? templates;

    // EXPORT
    private bool showExportModal = false;
    private int exportTab = 0; // 0 = Intervals, 1 = Wahoo
    private bool exportUseHr = true;
    private int exportFtp = 250;

    // NAPLÓZÁS / BEFEJEZÉS
    private bool showFinishModal = false;
    private int tempRpe = 5;
    private string tempFeeling = "neutral";
    // ... a meglévő ToggleTemplateMenu, SaveCurrentAsTemplate stb. alá ...

    // ÚJ METÓDUS: Sablon törlése
    private async Task DeleteTemplate(WorkoutTemplate t)
    {
        bool confirmed = await JSRuntime.InvokeAsync<bool>("confirm", $"Biztosan törlöd a '{t.Title}' sablont?");
        if (confirmed)
        {
            // Törlés az adatbázisból
            await Data.DeleteTemplateAsync(t.Id);

            // UI frissítése - JAVÍTVA: a kérdőjel (?) kezeli, ha a lista véletlenül null lenne
            templates?.Remove(t);

            StateHasChanged();
        }
    }

    // ... LoadTemplate és a többiek maradnak ...

    protected override async Task OnInitializedAsync()
    {
        workout = await Data.GetWorkoutByIdAsync(WorkoutId);
        if (workout != null)
        {
            var history = await Data.GetZoneHistoryForProfileAsync(workout.ProfileId);
            if (history.Any()) currentZoneSettings = history.First().ZonesData;
            else currentZoneSettings = new ZoneSnapshotData();
        }
    }

    // --- SABLON KEZELÉS ---
    private async Task ToggleTemplateMenu()
    {
        isTemplateMenuOpen = !isTemplateMenuOpen;
        if (isTemplateMenuOpen && workout != null)
        {
            templates = await Data.GetTemplatesAsync(workout.ProfileId);
        }
    }

    private async Task SaveCurrentAsTemplate()
    {
        if (workout != null)
        {
            string templateName = await JSRuntime.InvokeAsync<string>("prompt", "Mi legyen a sablon neve?", workout.Title);
            if (!string.IsNullOrWhiteSpace(templateName))
            {
                string originalTitle = workout.Title;
                workout.Title = templateName;
                await Data.SaveAsTemplateAsync(workout);
                workout.Title = originalTitle;
                isTemplateMenuOpen = false;
                await JSRuntime.InvokeVoidAsync("alert", "Sablon mentve!");
            }
        }
    }

    private async Task LoadTemplate(WorkoutTemplate t)
    {
        if (workout != null)
        {
            bool confirmed = await JSRuntime.InvokeAsync<bool>("confirm", "Biztosan betöltöd? Ez felülírja a jelenlegi lépéseket!");
            if (confirmed)
            {
                await Data.LoadTemplateIntoWorkoutAsync(workout.Id, t);
                workout = await Data.GetWorkoutByIdAsync(WorkoutId);
                isTemplateMenuOpen = false;
            }
        }
    }

    // --- NAPLÓZÁS ÉS BEFEJEZÉS ---
    private async Task ConfirmFinish()
    {
        if (workout != null)
        {
            workout.Status = "done";
            workout.Rpe = tempRpe;
            workout.Feeling = tempFeeling;
            await SaveWorkout();
            showFinishModal = false;
        }
    }

    private string GetRpeColor(int rpe)
    {
        if (rpe <= 4) return "text-success";
        if (rpe <= 7) return "text-warning";
        return "text-danger";
    }

    // --- MODAL / EXPORT ---
    private void OpenExportModal() => showExportModal = true;
    private void ToggleIntervalsMode(bool useHr) => exportUseHr = useHr;

    private async Task DownloadIntervalsFile()
    {
        if (workout == null) return;
        string content = Exporter.GenerateIntervalsIcuText(workout, currentZoneSettings!, exportUseHr);
        string fileName = $"{workout.Title.Replace(" ", "_")}_Intervals.txt";
        await JSRuntime.InvokeVoidAsync("downloadFileFromStream", fileName, content);
        showExportModal = false;
    }

    private async Task DownloadWahooZwo()
    {
        if (workout == null) return;
        string content = Exporter.GenerateZwoXml(workout, currentZoneSettings!, exportFtp);
        string fileName = $"{workout.Title.Replace(" ", "_")}.zwo";
        await JSRuntime.InvokeVoidAsync("downloadFileFromStream", fileName, content);
        showExportModal = false;
    }

    // --- SZERKESZTŐ LOGIKA ---
    private void SelectStep(WorkoutStep step) => selectedStep = step;

    private void AddSteadyState()
    {
        var step = new WorkoutStep { Type = "SteadyState", DurationSeconds = 600, Zone = "GA1" };
        workout!.Steps.Add(step);
        SelectStep(step);
    }
    private void AddInterval()
    {
        var step = new WorkoutStep { Type = "Intervals", RepeatCount = 5, DurationSeconds = 60, Zone = "EB", OffDurationSeconds = 60, OffZone = "KB" };
        workout!.Steps.Add(step);
        SelectStep(step);
    }
    private void RemoveStep(WorkoutStep step)
    {
        workout!.Steps.Remove(step);
        if (selectedStep == step) selectedStep = null;
    }

    private void UpdateTime(WorkoutStep step, object? value, bool isMinute, bool isWork)
    {
        if (value == null || !int.TryParse(value.ToString(), out int val)) return;
        int totalSec = isWork ? step.DurationSeconds : step.OffDurationSeconds;
        int currentMin = totalSec / 60;
        int currentSec = totalSec % 60;
        if (isMinute) currentMin = val; else currentSec = val;
        int newTotal = (currentMin * 60) + currentSec;
        if (isWork) step.DurationSeconds = newTotal; else step.OffDurationSeconds = newTotal;
    }

    private async Task SaveWorkout()
    {
        if (workout != null)
        {
            await Data.UpdateWorkoutAsync(workout);
            if (!showFinishModal) GoBack(); // Csak akkor lépünk vissza, ha sima mentés volt, nem a modalból jöttünk
        }
    }
    private async Task DeleteThisWorkout()
    {
        if (workout != null)
        {
            bool confirmed = await JSRuntime.InvokeAsync<bool>("confirm", "Biztosan törlöd?");
            if (confirmed)
            {
                await Data.DeleteWorkoutAsync(workout.Id);
                GoBack();
            }
        }
    }

    private void GoBack() => Nav.NavigateTo($"calendar/{workout?.ProfileId}");

    // Helpers
    private string FormatTime(int s) => (s % 60 == 0) ? $"{s / 60}p" : $"{s / 60}p {s % 60}mp";
    private string GetZoneColor(string z) => z switch { "KB" => "#808080", "GA1" => "#0d6efd", "GA2" => "#198754", "EB" => "#ffc107", "VO2" => "#fd7e14", "SB" => "#dc3545", "K3" => "#6f42c1", _ => "#fff" };
}
